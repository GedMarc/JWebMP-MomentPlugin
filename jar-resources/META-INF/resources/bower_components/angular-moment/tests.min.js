
"use strict";describe("module angularMoment",function(){var h,b,a,f,j,c,e,d,i,g;beforeEach(module("angularMoment"));beforeEach(inject(function(k){h=k.get("$rootScope");b=k.get("$compile");a=k.get("$window");f=k.get("$filter");j=k.get("moment");g=k.get("amMoment");c=k.get("amTimeAgoConfig");d=k.get("angularMomentConfig");e=angular.copy(c);i=angular.copy(d);(j.locale||j.lang)("en");j.tz.add("UTC|UTC|0|0|");j.tz.add("Europe/Zurich|CET CEST|-10 -20|01010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010|-19Lc0 11A0 1o00 11A0 1xG10 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00");j.tz.add("Pacific/Tahiti|LMT TAHT|9W.g a0|01|-2joe1.I");j.tz.setDefault(null)}));afterEach(function(){angular.copy(e,c);angular.copy(i,d)});describe("am-time-ago directive",function(){it("should be change output format after time through attributes amFullDateThreshold and amFullDateThresholdUnit",function(){h.testFormat="HH:mm";h.testDate=new Date(new Date().getTime()-5*60*1000);var k=angular.element('<span am-time-ago="testDate" am-full-date-threshold="5" am-full-date-threshold-unit="minute" am-full-date-format="{{ testFormat }}"></span>');k=b(k)(h);h.$digest();expect(k.text()).toBe(j(h.testDate).format(h.testFormat))});it("should not change output format after time through attributes amFullDateThreshold and amFullDateThresholdUnit",function(){h.testFormat="HH:mm";h.testDate=new Date(new Date().getTime()-4*60*1000);var k=angular.element('<span am-time-ago="testDate" am-full-date-threshold="5" am-full-date-threshold-unit="minute" am-full-date-format="{{ testFormat }}"></span>');k=b(k)(h);h.$digest();expect(k.text()).toBe("4 minutes ago")});it('should change the text of the element to "a few seconds ago" when given current time',function(){h.testDate=new Date();var k=angular.element('<span am-time-ago="testDate"></span>');k=b(k)(h);h.$digest();expect(k.text()).toBe("a few seconds ago")});it('should change the text of the div to "3 minutes ago" when given a date 3 minutes ago',function(){h.testDate=new Date(new Date().getTime()-3*60*1000);var k=angular.element('<div am-time-ago="testDate"></div>');k=b(k)(h);h.$digest();expect(k.text()).toBe("3 minutes ago")});it('should change the text of the div to "2 hours ago" when given a date 2 hours ago',function(){h.testDate=new Date(new Date().getTime()-2*60*60*1000);var k=angular.element('<div am-time-ago="testDate"></div>');k=b(k)(h);h.$digest();expect(k.text()).toBe("2 hours ago")});it('should change the text of the div to "a year ago" when given a date one year ago',function(){var k=new Date();h.testDate=new Date(k.getFullYear()-1,k.getMonth(),k.getDate());var l=angular.element('<div am-time-ago="testDate"></div>');l=b(l)(h);h.$digest();expect(l.text()).toBe("a year ago")});it("should parse correctly numeric dates as milliseconds since the epoch",function(){h.testDate=new Date().getTime();var k=angular.element('<div am-time-ago="testDate"></div>');k=b(k)(h);h.$digest();expect(k.text()).toBe("a few seconds ago")});it("should update the value if date changes on scope",function(){var k=new Date();h.testDate=new Date(k.getFullYear()-1,k.getMonth(),k.getDate()).getTime();var l=angular.element('<div am-time-ago="testDate"></div>');l=b(l)(h);h.$digest();expect(l.text()).toBe("a year ago");h.testDate=new Date();h.$digest();expect(l.text()).toBe("a few seconds ago")});it("should update the span text as time passes",function(k){h.testDate=new Date(new Date().getTime()-44000);var l=angular.element('<div am-time-ago="testDate"></div>');l=b(l)(h);h.$digest();expect(l.text()).toBe("a few seconds ago");var m=setInterval(function(){if(new Date().getTime()-h.testDate.getTime()<45200){return}clearInterval(m);h.$digest();expect(l.text()).toBe("a minute ago");k()},50)});it("should schedule the update timer to one hour ahead for date in the far future (#73)",function(){h.testDate=new Date(new Date().getTime()+86400000);spyOn(a,"setTimeout");var k=angular.element('<div am-time-ago="testDate"></div>');k=b(k)(h);h.$digest();expect(a.setTimeout).toHaveBeenCalledWith(jasmine.any(Function),3600000)});describe("bindonce",function(){it('should change the text of the div to "3 minutes ago" when given a date 3 minutes ago with one time binding',function(){h.testDate=new Date(new Date().getTime()-3*60*1000);var k=angular.element('<div am-time-ago="::testDate"></div>');k=b(k)(h);h.$digest();expect(k.text()).toBe("3 minutes ago")});it("should parse correctly numeric dates as milliseconds since the epoch with one time binding",function(){h.testDate=new Date().getTime();var k=angular.element('<div am-time-ago="::testDate"></div>');k=b(k)(h);h.$digest();expect(k.text()).toBe("a few seconds ago")});it("should not update the value if date changes on scope when using one time binding",function(){var k=new Date();h.testDate=new Date(k.getFullYear()-1,k.getMonth(),k.getDate()).getTime();var l=angular.element('<div am-time-ago="::testDate"></div>');l=b(l)(h);h.$digest();expect(l.text()).toBe("a year ago");h.testDate=new Date();h.$digest();expect(l.text()).toBe("a year ago")})});it("should handle undefined data",function(){h.testDate=null;var k=angular.element('<div am-time-ago="testDate"></div>');k=b(k)(h);var l=function(){h.$digest()};expect(l).not.toThrow()});it("should remove the element text and cancel the timer when an empty string is given (#15)",function(){h.testDate=new Date().getTime();var k=angular.element('<div am-time-ago="testDate"></div>');k=b(k)(h);h.$digest();expect(k.text()).toBe("a few seconds ago");h.testDate="";spyOn(a,"clearTimeout").and.callThrough();h.$digest();expect(a.clearTimeout).toHaveBeenCalled();expect(k.text()).toBe("")});it("should not change the contents of the element until a date is given",function(){h.testDate=null;var k=angular.element('<div am-time-ago="testDate">Initial text</div>');k=b(k)(h);h.$digest();expect(k.text()).toBe("Initial text");h.testDate=new Date().getTime();h.$digest();expect(k.text()).toBe("a few seconds ago")});it("should cancel the timer when the scope is destroyed",function(){var l=h.$new();h.testDate=new Date();var k=angular.element('<span am-time-ago="testDate"></span>');k=b(k)(l);h.$digest();spyOn(a,"clearTimeout").and.callThrough();l.$destroy();expect(a.clearTimeout).toHaveBeenCalled()});it("should generate a time string without suffix when configured to do so",function(){c.withoutSuffix=true;h.testDate=new Date();var k=angular.element('<span am-time-ago="testDate"></span>');k=b(k)(h);h.$digest();expect(k.text()).toBe("a few seconds")});it("should generate update the text following a locale change via amMoment.changeLocale() method",function(){h.testDate=new Date();var k=angular.element('<span am-time-ago="testDate"></span>');k=b(k)(h);h.$digest();expect(k.text()).toBe("a few seconds ago");g.changeLocale("fr");expect(k.text()).toBe("il y a quelques secondes")});it("should update the `datetime` attr if applied to a TIME element",function(){h.testDate=Date.UTC(2012,8,20,15,20,12);var k=angular.element('<time am-time-ago="testDate"></span>');k=b(k)(h);h.$digest();expect(k.attr("datetime")).toBe("2012-09-20T15:20:12.000Z")});describe("setting the element title",function(){it("should not set the title attribute of the element to the date by default",function(){h.testDate=new Date().getTime()/1000;var k=angular.element('<span am-time-ago="testDate"></span>');k=b(k)(h);h.$digest();expect(k.attr("title")).toBeUndefined()});it("should not change the title attribute of the element if the element already has a title",function(){c.titleFormat="MMMM Do YYYY, h:mm:ss a";h.testDate=new Date().getTime()/1000;var k=angular.element('<span am-time-ago="testDate" title="test"></span>');k=b(k)(h);h.$digest();expect(k.attr("title")).toBe("test")});it("should set the title attribute of the element to the formatted date as per the config",function(){c.titleFormat="MMMM Do YYYY, h:mm:ss a";h.testDate=new Date().getTime()/1000;var l=angular.element('<span am-time-ago="testDate"></span>');l=b(l)(h);h.$digest();var k=j(h.testDate).format(c.titleFormat);expect(l.attr("title")).toBe(k)});it("should update the title attribute of the element if the binding model changed",function(){c.titleFormat="MMMM Do YYYY, h:mm:ss a";h.testDate=Date.UTC(2015,11,10,18,44,12);var l=angular.element('<span am-time-ago="testDate"></span>');l=b(l)(h);h.$digest();h.testDate=Date.UTC(2015,11,10,19,43,34);h.$digest();var k=j(h.testDate).format(c.titleFormat);expect(l.attr("title")).toBe(k)});describe("full date support",function(){it("should display relative time if the date is recent",function(){c.fullDateThreshold=7;h.testDate=new Date(new Date().getTime()-2*24*60*60*1000);var k=angular.element('<span am-time-ago="testDate"></span>');k=b(k)(h);h.$digest();expect(k.text()).toBe("2 days ago")});it("should display full time if the date is past the threshold",function(){c.fullDateThreshold=7;h.testDate=new Date(2012,5,5);var k=angular.element('<span am-time-ago="testDate"></span>');k=b(k)(h);h.$digest();expect(k.text()).toMatch(/^2012-06-05T00:00:00[\+\-]\d\d:\d\d$/)});it("should display full time using the given format",function(){c.fullDateThreshold=7;c.fullDateFormat="YYYY,DD,MM";h.testDate=new Date(2010,1,8);var k=angular.element('<span am-time-ago="testDate"></span>');k=b(k)(h);h.$digest();expect(k.text()).toBe("2010,08,02")});it("should support changing the full date threshold through attribute",function(){h.threshold=7;h.testDate=new Date(new Date().getTime()-12*24*60*60*1000);var k=angular.element('<span am-time-ago="testDate" am-full-date-threshold="{{threshold}}"></span>');k=b(k)(h);h.$digest();expect(k.text()).toBe(j(h.testDate).format());h.threshold=20;h.$digest();expect(k.text()).toBe("12 days ago")});it("should support setting the full date format through attribute",function(){c.fullDateThreshold=7;h.testDate=new Date(2013,11,15);var k=angular.element('<span am-time-ago="testDate" am-full-date-format="YYYY-MM-DD"></span>');k=b(k)(h);h.$digest();expect(k.text()).toBe("2013-12-15")})});describe("am-from attribute",function(){it("should make the calculations from the am-from given",function(){h.from=new Date(2015,6,11);h.testDate=new Date(2015,6,12);var k=angular.element('<span am-time-ago="testDate" am-from="from"></span>');k=b(k)(h);h.$digest();expect(k.text()).toBe("in a day")})})});describe("am-without-suffix attribute",function(){it("should generate a time string without suffix when true",function(){h.testDate=new Date();var k=angular.element('<span am-time-ago="testDate" am-without-suffix="true"></span>');k=b(k)(h);h.$digest();expect(k.text()).toBe("a few seconds")});it("should generate a time string with suffix when false",function(){c.withoutSuffix=true;h.testDate=new Date();var k=angular.element('<span am-time-ago="testDate" am-without-suffix="false"></span>');k=b(k)(h);h.$digest();expect(k.text()).toBe("a few seconds ago")});it("should support expressions",function(){h.testDate=new Date();h.withSuffix=false;var k=angular.element('<span am-time-ago="testDate" am-without-suffix="!withSuffix"></span>');k=b(k)(h);h.$digest();expect(k.text()).toBe("a few seconds");h.withSuffix=true;h.$digest();expect(k.text()).toBe("a few seconds ago")});it("should ignore non-boolean values",function(){h.testDate=new Date();h.withoutSuffix="string";var k=angular.element('<span am-time-ago="testDate" am-without-suffix="withoutSuffix"></span>');k=b(k)(h);h.$digest();expect(k.text()).toBe("a few seconds ago")})});describe("serverTime configuration",function(){it("should calculate time ago in respect to the configured server time",function(){c.serverTime=Date.UTC(2014,5,12,5,22,11);h.testDate=Date.UTC(2014,5,12,9,22,11);var k=angular.element('<span am-time-ago="testDate"></span>');k=b(k)(h);h.$digest();expect(k.text()).toBe("in 4 hours")})})});describe("amFromUnix filter",function(){var k;beforeEach(function(){k=f("amFromUnix")});it("should convert a unix-timestamp into a moment object with the correct time value",function(){var l=k(1422095523);expect(j.isMoment(l)).toBe(true);expect(l.valueOf()).toBe(1422095523000)})});describe("amUtc filter",function(){var k;beforeEach(function(){k=f("amUtc")});it("should create a UTC moment from the given date",function(){var l=k(new Date());expect(j.isMoment(l)).toBe(true);expect(l.utcOffset()).toBe(0)})});describe("amLocal filter",function(){var k;beforeEach(function(){k=f("amLocal")});it("should convert the given moment object into local object",function(){var n=j().utcOffset();var m=j.utc();var l=k(m);expect(j.isMoment(l)).toBe(true);expect(l.utcOffset()).toBe(n)});it("should return null if a non moment object was given",function(){expect(k(null)).toBe(null);expect(k("test")).toBe(null);expect(k(new Date())).toBe(null)})});describe("amParse filter",function(){var k;beforeEach(function(){k=f("amParse")});it("should parse the given date string according to the given format, and return a moment object",function(){var l=k("2015#09#13","YYYY#MM#DD");expect(j.isMoment(l)).toBe(true);expect(l.year()).toBe(2015);expect(l.month()).toBe(8);expect(l.date()).toBe(13)})});describe("amTimezone filter",function(){var k;beforeEach(function(){k=f("amTimezone")});it("should apply the given timezone",function(){var m=Date.UTC(2012,0,22,12,46,54);var l=k(m,"Pacific/Tahiti");expect(l.utcOffset()).toBe(-600);expect(l.format("YYYY-MM-DD HH:mm:ss")).toBe("2012-01-22 02:46:54")});it("should parse timezones containing Z correctly (issue #168)",function(){var m=Date.UTC(2015,8,3,23,55,55);var l=k(m,"Europe/Zurich");expect(l.utcOffset()).toBe(120);expect(l.format("YYYY-MM-DD HH:mm:ss")).toBe("2015-09-04 01:55:55")});it("should gracefully handle the case where moment-timezone is not loaded",function(){var n=Date.UTC(2012,0,22,12,46,54);var m=j.fn.tz;try{delete j.fn.tz;var l=k(n,"Pacific/Tahiti");expect(j.isMoment(l)).toBe(true)}finally{j.fn.tz=m;j.fn.tz=m}});it("should not cause infinite digest loop when combined with am-time-ago",function(){h.testDate=new Date();var l=angular.element("<div am-time-ago=\"testDate|amTimezone:'UTC'\"></div>");l=b(l)(h);h.$digest()})});describe("amUtcOffset filter",function(){var k;beforeEach(function(){k=f("amUtcOffset")});it("should accept a numeric UTC offset and apply it to the given date / moment",function(){var m=Date.UTC(2012,0,22,12,46,54);var l=k(m,-450);expect(l.utcOffset()).toBe(-450);expect(l.format("YYYY-MM-DD HH:mm:ss")).toBe("2012-01-22 05:16:54")});it("should accept a string UTC offset and apply it to the given date / moment",function(){var m=Date.UTC(2012,0,22,12,46,54);var l=k(m,"-08:00");expect(l.utcOffset()).toBe(-480);expect(l.format("YYYY-MM-DD HH:mm:ss")).toBe("2012-01-22 04:46:54")})});describe("amCalendar filter",function(){var k;beforeEach(function(){k=f("amCalendar")});it("should convert today date to calendar form",function(){var m=new Date();var l=new Date(m.getFullYear(),m.getMonth(),m.getDate(),13,33,33);expect(k(l)).toBe("Today at 1:33 PM")});it("should convert date in long past to calendar form",function(){expect(k(new Date(2012,2,25,13,14,15))).toBe("03/25/2012")});it("should gracefully handle undefined values",function(){expect(k()).toBe("")});it("should accept a numeric unix timestamp (milliseconds since the epoch) as input",function(){expect(k(new Date(2012,0,22,4,46,54).getTime())).toBe("01/22/2012")});it("should return an empty string for invalid input",function(){expect(k("blah blah")).toBe("")});it("should take advanced arguments referenceTime and formats",function(){expect(k(new Date(2012,0,22,4,46,54),new Date(2012,0,23,4,46,54),{lastDay:"[Yesterday at] H:m"})).toBe("Yesterday at 4:46")})});describe("amDifference filter",function(){var k;beforeEach(function(){k=f("amDifference")});it("should take the difference of two dates in milliseconds",function(){var m=new Date(2012,0,22,0,0,0);var l=new Date(m.getFullYear(),m.getMonth(),m.getDate(),13,33,33);expect(k(l,m)).toBe(48813000)});it('should support passing "years", "months", "days", etc as a units parameter',function(){var o=new Date(2012,0,22,4,46,54);var n=new Date(2013,0,22,4,46,54);expect(k(n,o,"years")).toBe(1);var m=new Date(2012,1,22,4,46,54);expect(k(m,o,"months")).toBe(1);var l=new Date(2012,0,23,4,46,54);expect(k(l,o,"days")).toBe(1)});it("should allow rounding to be disabled via parameter",function(){var m=new Date(2012,0,22,4,46,54);var l=new Date(m.getFullYear()+1,m.getMonth()+6,m.getDate());expect(k(l,m,"years")).toBe(1);expect(k(l,m,"years",true)).toBeCloseTo(1.5)});it("dates from the future should return negative values",function(){var m=new Date(2012,0,22,4,46,54);var l=new Date(2013,0,22,4,46,54);expect(String(k(m,l))).toContain("-")});it("should gracefully handle undefined values",function(){expect(k()).toBe("")});it("should accept a numeric unix timestamp (milliseconds since the epoch) as input",function(){expect(k(new Date(2012,0,22,4,46,55).getTime(),new Date(2012,0,22,4,46,54).getTime())).toBe(1000)});it("should return an empty string for invalid input",function(){expect(k("blah blah")).toBe("")})});describe("amDateFormat filter",function(){var k;beforeEach(function(){k=f("amDateFormat")});it("should support displaying format",function(){var l=new Date();var m=l.getDate()+"."+(l.getMonth()+1)+"."+l.getFullYear();expect(k(l,"D.M.YYYY")).toBe(m)});it("should gracefully handle undefined values",function(){expect(k(undefined,"D.M.YYYY")).toBe("")});it("should accept a numeric unix timestamp (milliseconds since the epoch) as input",function(){var l=new Date(2012,0,22,12,46,54).getTime();expect(k(l,"(HH,mm,ss);MM.DD.YYYY")).toBe("(12,46,54);01.22.2012")});it("should gracefully handle string unix timestamp as input",function(){var l=String(new Date(2012,0,22,12,46,54).getTime());expect(k(l,"(HH,mm,ss);MM.DD.YYYY")).toBe("(12,46,54);01.22.2012")});it("should respect the configured timezone",function(){d.timezone="Pacific/Tahiti";var l=Date.UTC(2012,0,22,12,46,54);expect(k(l,"(HH,mm,ss);MM.DD.YYYY")).toBe("(02,46,54);01.22.2012")});it("should return an empty string for invalid input",function(){expect(k("blah blah","(HH,mm,ss);MM.DD.YYYY")).toBe("")})});describe("amDurationFormat filter",function(){var k;beforeEach(function(){k=f("amDurationFormat")});it("should support return the given duration as text",function(){expect(k(1000,"milliseconds")).toBe("a few seconds")});it("should support return a day given 24 hours",function(){expect(k(24,"hours")).toBe("a day")});it('should add prefix the result with the word "in" if the third parameter (suffix) is true',function(){expect(k(1,"minutes",true)).toBe("in a minute")});it('should add suffix the result with the word "ago" if the duration is negative and the third parameter is true',function(){expect(k(-1,"minutes",true)).toBe("a minute ago")});it("should gracefully handle undefined values for duration",function(){expect(k(undefined,"minutes")).toBe("")})});describe("amTimeAgo filter",function(){var k;beforeEach(function(){k=f("amTimeAgo")});it("should support return the time ago as text",function(){var l=new Date();expect(k(l)).toBe("a few seconds ago")});it("should remove suffix from the result if the second parameter (suffix) is true",function(){var l=new Date();expect(k(l,true)).toBe("a few seconds")});it("should support starting date as third parameter",function(){var l=new Date(2015,7,14),m=new Date(2015,7,15);expect(k(l,null,m)).toBe("a day ago");expect(k(l,true,m)).toBe("a day")});it("should gracefully handle undefined values",function(){expect(k()).toBe("")});it("should gracefully handle invalid input",function(){expect(k("noDate")).toBe("")})});describe("amSubtract filter",function(){var k;beforeEach(function(){k=f("amSubtract")});it("should subtract 1 hour from date",function(){var l=new Date(2000,1,1,0,0,0);expect(k(l,1,"hours").toString()).toMatch(/^Mon Jan 31 2000 23:00:00/)});it("should subtract 1 minute from date",function(){var l=new Date(2000,1,1,0,0,0);expect(k(l,1,"minutes").toString()).toMatch(/^Mon Jan 31 2000 23:59:00/)})});describe("amAdd filter",function(){var k;beforeEach(function(){k=f("amAdd")});it("should add 1 hour to date",function(){var l=new Date(2000,1,1,0,0,0);expect(k(l,1,"hours").toString()).toMatch(/^Tue Feb 01 2000 01:00:00/)});it("should add 1 minute to date",function(){var l=new Date(2000,1,1,0,0,0);expect(k(l,1,"minutes").toString()).toMatch(/^Tue Feb 01 2000 00:01:00/)})});describe("amStartOf filter",function(){var k;beforeEach(function(){k=f("amStartOf")});it("should set date to start of the hour",function(){var l=new Date(2000,1,0,12,12,12);expect(k(l,"hour").toString()).toMatch(/^Mon Jan 31 2000 12:00:00/)});it("should set date to start of the day",function(){var l=new Date(2000,1,0,12,12,12);expect(k(l,"day").toString()).toMatch(/^Mon Jan 31 2000 00:00:00/)});it("should set date to start of the week",function(){var l=new Date(2000,1,10,12,12,12);expect(k(l,"week").toString()).toMatch(/^Sun Feb 06 2000 00:00:00/)});it("should set date to start of the year",function(){var l=new Date(2000,6,6,12,12,12);expect(k(l,"year").toString()).toMatch(/^Sat Jan 01 2000 00:00:00/)})});describe("amEndOf filter",function(){var k;beforeEach(function(){k=f("amEndOf")});it("should set date to end of the hour",function(){var l=new Date(2000,0,1,12,12,12);expect(k(l,"hour").toString()).toMatch(/^Sat Jan 01 2000 12:59:59/)});it("should set date to end of the day",function(){var l=new Date(2000,0,1,12,12,12);expect(k(l,"day").toString()).toMatch(/^Sat Jan 01 2000 23:59:59/)});it("should set date to end of the week",function(){var l=new Date(2000,0,10,12,12,12);expect(k(l,"week").toString()).toMatch(/^Sat Jan 15 2000 23:59:59/)});it("should set date to end of the year",function(){var l=new Date(2000,6,6,12,12,12);expect(k(l,"year").toString()).toMatch(/^Sun Dec 31 2000 23:59:59/)})});describe("amMoment service",function(){describe("#changeLocale",function(){it("should convert today's date to custom calendar format",function(){var l=new Date();g.changeLocale("en",{calendar:{sameDay:"[This Day]"}});var m=f("amCalendar");var k=new Date(l.getFullYear(),l.getMonth(),l.getDate(),13,33,33);expect(m(k)).toBe("This Day")});it("should return the current locale",function(){expect(g.changeLocale()).toBe("en")});it("should broadcast an angularMoment:localeChanged event on the root scope if a locale is specified",function(){var k=false;h.$on("amMoment:localeChanged",function(){k=true});g.changeLocale("fr");expect(k).toBe(true)});it("should not broadcast an angularMoment:localeChanged event on the root scope if no locale is specified",function(){var k=false;h.$on("amMoment:localeChanged",function(){k=true});g.changeLocale();expect(k).toBe(false)})});describe("#changeTimezone",function(){it("Should update the current timezone",function(){g.changeTimezone("UTC");expect(g.preprocessDate(j()).utcOffset()).toBe(0);g.changeTimezone("Pacific/Tahiti");expect(g.preprocessDate(j()).utcOffset()).toBe(-600)});it("should broadcast an angularMoment:timezoneChanged event on the root scope with the new timezone value",function(){var k=false;h.$on("amMoment:timezoneChanged",function(){k=true});g.changeTimezone("UTC");expect(k).toBe(true)})});describe("#preprocessDate",function(){it("should call a custom preprocessor set by `angularMomentConfig.preprocess`",function(){var k=new Date(2013,0,22,12,46,54);var l={name:"Budget plan",date:k};d.preprocess=function(m){return j(m.date)};expect(g.preprocessDate(l,"foobar").valueOf()).toEqual(k.getTime())});it("should respect the default timezone",function(){d.timezone="Pacific/Tahiti";expect(g.preprocessDate(new Date()).utcOffset()).toBe(-600)})})});describe("amTimeAgoConfig constant",function(){it("should generate time with suffix by default",function(){expect(c.withoutSuffix).toBe(false)})});describe("angularMomentConfig constant",function(){it("should have an empty timezone value by default",function(){expect(d.timezone).toBe(null)});it("should have an empty preprocess value by default",function(){expect(d.preprocess).toBe(null)})})});

 
